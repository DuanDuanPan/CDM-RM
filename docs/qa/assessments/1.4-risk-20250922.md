# 风险画像：故事 1.4 Prisma 基线与迁移

日期：2025-09-22
评审人：Quinn（测试架构师）

## 概览

- 风险总数：4
- 致命：0｜高：2｜中：2

## 高风险

### MIG-001：缺少初始迁移
评分：6（高）｜概率：中（2）×影响：高（3）
- 缓解：创建并提交首个迁移；确定迁移命名规范

### CI-DB-001：CI 未验证迁移/回滚
评分：6（高）
- 缓解：CI 执行 `prisma generate`、`migrate deploy`，并验证最小回滚路径

## 中风险

### IDX-001：JSONB/高频字段索引不完善
评分：4（中）
- 缓解：按查询模式补充索引（必要时用 raw SQL 迁移）

### ENV-DB-001：数据库连接配置缺校验
评分：4（中）
- 缓解：dotenv-safe/envalid 校验，提供 .env.example

## 基于风险的测试策略

1. CI 中新增迁移/回滚烟囱测试
2. 针对高频查询设计索引回归测试（Explain/SLOW）
