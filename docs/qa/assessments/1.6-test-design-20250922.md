# 测试设计：故事 1.6 日志与追踪

日期：2025-09-22｜设计者：Quinn

## 场景

- 场景总数：6｜单元：3｜集成：3

AC1：注入 requestId/traceId；回传 `x-trace-id`

| ID           | 层级 | 优先级 | 测试内容                                       |
|--------------|------|--------|-----------------------------------------------|
| 1.6-INT-001  | 集成 | P0     | 请求返回 200 且响应头含 `x-trace-id`          |
| 1.6-INT-002  | 集成 | P0     | 日志条目包含 traceId/reqId                    |

AC2：日志字段规范与脱敏

| ID           | 层级 | 优先级 | 测试内容                                       |
|--------------|------|--------|-----------------------------------------------|
| 1.6-UNIT-001 | 单元 | P0     | 脱敏函数对机密字段进行屏蔽/替换                |
| 1.6-UNIT-002 | 单元 | P1     | 字段白名单校验（ts/level/service/...）         |

AC3：禁止打印 PII/密钥

| ID           | 层级 | 优先级 | 测试内容                                       |
|--------------|------|--------|-----------------------------------------------|
| 1.6-UNIT-003 | 单元 | P0     | 关键关键字/模式被过滤                         |
| 1.6-INT-003  | 集成 | P1     | 模拟包含敏感字段请求，日志中不出现原文        |

```yaml
test_design:
  scenarios_total: 6
  by_level: { unit: 3, integration: 3 }
  by_priority: { p0: 4, p1: 2 }
  coverage_gaps: []
```

