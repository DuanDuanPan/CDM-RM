# 2. Requirements

## 2.1 Functional Requirements (FR)
- FR1: 支持导入 DOORS REQIF（首选），可选兼容 CSV；支持通过 DXL 直接同步 DOORS 中的需求（MVP 使用 Mock，同步与接口预留真实端点切换）
- FR2: 维护系统需求模板与中英映射，可配置并可冻结基线（版本化）
- FR3: 从原始/系统需求中抽取指标，支持规则/正则/词典（MDM）、大模型抽取（LLM），并提供人工复核兜底
- FR4: 统一单位/量纲并进行换算；校验范围/阈值与取值域
- FR5: 溯源与去重（ModuleID/ObjectID/BaselineID；来源ID+标题/内容哈希）
- FR6: 需求/指标绑定 RBOM（Part 级），建立最小 RBOM 基线
- FR7: 系统需求支持拆分/合并，并保留溯源关系
- FR8: 支持需求结构管理，结构与 DOORS 模块对应（按模块/层级浏览与统计）
- FR9: 系统需求支持新增/修改/删除；从 DOORS 同步的需求不可删除（仅允许状态/属性更新）
- FR10: 支持查询与过滤（按模块/版本/状态/责任人/关键字等）
- FR11: 支持自动编码，编码规则可配置（前缀/序列/位数/校验）
- FR12: 生成差异（变更类型/对象/级别/责任人），支持过滤/分组/导出（CSV/Markdown）
- FR13: 差异派生更改单/变更包并自动路由责任人
- FR14: 站内信/OA 通知（支持合并），记录送达/阅读/确认
- FR15: 工作包下发与收件箱 Ack 确认（责任到人）
- FR16: 接收交付物与验证结果（文件/链接 + 结构化结论），与需求/指标/用例双向追溯
- FR17: 当影响≥中时，自动将相关用例标记为失效并派生更新任务
- FR18: 按变更包生成回归批次；看板按 RBOM 层级展示通过率/阻塞项/剩余工作量
- FR19: 需求反写 DOORS：将状态、交付物等信息写回（MVP 使用 Mock，预留真实端点切换）
- FR20: 标杆对比：导入/维护标杆产品的核心指标，自动对比并识别风险项
- FR21: 需求规格说明书（SRS）导入与导出（DOC/DOCX 优先；选配 Markdown）
- FR22: 型谱选用：从需求指标/条目出发，推荐型谱化产品（可多选），给出匹配理由；支持 Top-N 推荐与规则可配置（权重/得分阈值）
- FR23: 提供 API 端点：/import, /diffs, /changes, /notifications, /rbom, /metrics, /dispatch, /work-packages, /deliverables, /verifications, /closure
- FR24: 审计日志：记录导入/修改/通知等关键操作（操作者、时间戳、对象、结果），支持查询
- FR25: 集成要求：DOORS REQIF/（可选 CSV）导入、RBOM 数据源导入、站内信/OA HTTP 适配（MVP 用 Mock；DXL 同步与 DOORS 反写预留）

（动态建模与低代码配置能力：仅覆盖“需求条目”实体）
- FR26: 需求元模型配置：仅对“需求条目（原始/系统需求）”支持自定义字段与属性描述，允许按模块定义字段集合与可见性
- FR27: 需求字段类型与校验：支持文本/富文本、数值（含单位）、布尔、日期/时间、枚举（词典/MDM）、多选、引用（需求间关联）、附件、JSON、公式/计算字段；支持必填/默认值/范围/正则等校验
- FR28: 需求模型版本化与迁移：字段/结构变更须版本化与审计；提供数据迁移策略（自动/脚本）；保障与 DOORS 字段映射的兼容性；支持基线冻结与回滚
- FR29: 需求动态表单与列表：基于需求元模型自动生成“创建/编辑/查看”表单与列表视图；支持布局与条件显隐、字段级只读/隐藏（按角色），提供预览
- FR30: 需求规则与触发（MVP 最小）：支持对需求条目配置最小触发器（如字段变更→派发通知/任务）；后续扩展低代码规则引擎（权重/阈值可配置）
- FR31: 需求元模型 API：提供获取需求元模型/字段定义与动态校验的 API；支持对自定义字段的查询/过滤/排序（含 JSONB 路径）
- FR32: 权限：需求元模型/字段/规则变更仅限特定角色（建议新增 Configurator），支持字段级权限（可见/编辑）
- FR33: 审计：需求模型与配置变更需完整留痕（操作者/时间/差异），支持回滚
- FR34: 需求动态表格：基于需求元模型生成可配置表格视图（列选择/顺序/冻结与宽度、排序/筛选/分组/汇总、列公式）；支持内联编辑（受字段权限）、批量操作、保存/共享视图（用户/角色）、导出 CSV/Excel；支持服务端分页/排序/过滤
 - FR35: 列级权限：按角色/条件控制需求字段/表格列的可见/可编辑（服务端强制），默认拒绝（deny-by-default）；所有访问与变更写审计
 - FR36: 视图共享与治理：视图可设为私有/团队/组织/角色；支持发布/下线、默认视图置顶、Owner/Editor/Viewer 权限模型与版本审计
 - FR37: 导出映射与预设：导出 CSV/Excel 时复用字段映射与多语言表头；支持保存导出预设（与 SRS 模板字段映射一致），导出遵循列级权限

## 2.2 Non-Functional Requirements (NFR)
- NFR1: 性能目标：10 条样本导入 < 2 分钟；导入后 ≤ 5 分钟内完成差异与通知
- NFR2: 可靠性与运营目标：通知送达率 ≥ 99%，阅读/确认率 ≥ 95%；回归通过率 ≥ 90%，阻塞项清零 ≤ 2 天
- NFR3: 安全与权限：RBAC（Viewer/Editor/Reviewer/Admin）；最小权限；只读/编辑边界清晰
- NFR4: 合规与审计：全链路审计日志；配置化枚举与词典（MDM）加载；环境变量管理（.env），密钥不入库
- NFR5: 隐私与保密：数据“永久保留”，保留与访问须符合企业保密规定（保密要求优先）
- NFR6: 本地化与时间：ISO 8601 + Asia/Shanghai（UTC+8）
- NFR7: 可恢复性：关键流程提供严格人工回滚 SOP，并完整留痕
- NFR8: 可观测性：采集系统日志、队列事件、数据库聚合以支撑 KPI 统计
- NFR9: 可配置性：词典/映射可热更新，尽量避免频繁发版
- NFR10: 集成策略：MVP 使用 Mock 适配器，可通过环境变量切换真实端点
 - NFR11: RBAC 治理：默认拒绝（deny-by-default）；服务端强制字段/列级权限；角色矩阵（Viewer/Editor/Reviewer/Admin/Configurator）；配置变更需审计
 - NFR12: 视图共享治理：视图支持私有/团队/组织/角色范围；“组织/角色级发布”需至少 1 名 Reviewer 审批；支持有效期（TTL）、撤销与历史版本审计；定期（周）输出共享视图清单与访问统计
 - NFR13: 导出治理：导出遵循同一权限检查；默认开启水印（导出者、时间、视图ID/traceId）；支持字段脱敏与列白名单；导出条数/频率可限流，支持审批阈值（如>5k 行需审批）
 - NFR14: 违规检测：未授权访问/导出告警；失败/绕权重试封禁（含 IP/账号）；每月安全巡检（密钥/依赖/审计抽样）

---
